{%extends "userportal/base/qfpay_base.html"%}

{%block title%} 钱方-个体户注册 {%endblock%}

{%block resource%}
{{block.super}}
<link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.7/themes/redmond/jquery-ui.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.7/jquery-ui.min.js"></script>
<script type="text/javascript" src="https://jquery-ui.googlecode.com/svn/trunk/ui/i18n/jquery.ui.datepicker-zh-CN.js"></script>
	<style>
	.ui-datepicker select.ui-datepicker-month, .ui-datepicker select.ui-datepicker-year{	
		width:45%;
	}
	</style>
<script type="text/javascript">
    $(document).ready(function () {
        $.initProv("#pro", "#city", "北京市", "东城区");
        $.initProv("#bpro", "#bcity", "北京市", "东城区");
    });

    $(document).ready(function () {
        $(".selector").datepicker({ showOn:'focus',changeMonth:true,changeYear:true, minDate:new Date()});
    });  
</script>

{%endblock%}

{%block container%}
<div class="container">
    <div class="clearfix">
        <div class="process" id="process2"></div>
        <form class="clearfix mt_20" method="POST" action="/signup2">
            <div class="clearfix verify_tip">
                <label class="clearfix"> <span class="input_title">字号名称</span> {{spersonform.shopname}} </label>
                <span class="tipImg"></span>
                <span class="errTip">输入不能为空</span>
                <span class="errors">{{spersonform.errors.shopname.as_text}}</span>
            </div>
            <div class="clearfix verify">
                <label class="clearfix"> <span class="input_title">邮箱</span> {{spersonform.email}} </label>
            </div>

            <div class="clearfix verify_tip">
                <label class="clearfix"> <span class="input_title">收据显示名称</span> {{spersonform.nickname}} </label>
                <span class="tipImg"></span>
                <span class="errTip">输入不能为空</span>
                <span class="errors">{{spersonform.errors.nickname.as_text}}</span>
            </div>


            <div class="clearfix verify">
                <label class="clearfix"> <span class="input_title">经营者姓名</span> {{spersonform.legalperson}} </label>
            </div>
            <div class="clearfix verify_tip">
                <label class="clearfix"> <span class="input_title">经营者身份证号</span> {{spersonform.idnumber}} </label>
				<span class="tipImg"></span>
                <span class="errTip">输入不能为空</span>
                <span class="errors">{{spersonform.errors.idnumber.as_text}}</span>
            </div>
            <!--div class="clearfix verify_tip">
                <label> <span class="input_title">有效期至</span> 
				{{spersonform.idstatdate}} -->
				 <!--<select id="year1" onchange="TUpdateCal(ymd.year1.value,ymd.month1.value)"></select><span class="dates">年</span>
                 <select id="month1" onchange="TUpdateCal(ymd.year1.value,ymd.month1.value)" ></select><span class="dates">月</span>
                 <select id="day1"></select><span class="dates">日</span>
				</label>
                <span class="tipImg"></span><span class="errTip">输入不能为空</span>
                <label class="to"> <span>至</span>
				<!{{spersonform.idenddate}}-->
				<!--/label>
                <span class="tipImg"></span><span class="errTip">输入不能为空</span>
                <span class="errors">{{spersonform.errors.idstatdate.as_text}}</span>
            </div-->
            <div class="clearfix verify_tip">
                <span class="input_title">经营地址</span> 
                <select name="province" class="f1" id="pro"></select> 
                <select name="city" class="f1" id="city"></select>
                <span class="tipImg"></span><span class="errTip">输入不能为空</span>
                <span class="errors">{{spersonform.errors.businessaddr.as_text}}</span>
            </div>
			<div class="clearfix verify_tip">
                <span class="input_title"></span> 
                <label class="clearfix"> {{spersonform.businessaddr}} </label>
                <span class="tipImg"></span><span class="errTip">输入不能为空</span>
                <span class="errors">{{spersonform.errors.businessaddr.as_text}}</span>
            </div>

            <div class="clearfix verify">
                <label class="clearfix"> <span class="input_title">固定电话号码</span> {{spersonform.telephone}} </label>
                <span class="tipImg"></span><span class="errTip">输入不能为空</span>
                <span class="errors">{{spersonform.errors.telephone.as_text}}</span>
            </div>
            <div class="clearfix verify_tip">
                <label class="clearfix"> <span class="input_title">营业执照注册号</span> {{spersonform.licensenumber}} </label>
                <span class="tipImg"></span><span class="errTip">输入不能为空</span>
                <span class="errors">{{spersonform.errors.licenseenddate.as_text}}</span>
                <!--<label> <span class="ml_20 fl">有效期</span>{{spersonform.licenseenddate}}</label>
                <span class="tipImg"></span><span class="errTip">输入不能为空</span>-->
            </div>
            <!--div class="clearfix verify_tip">
                <span class="input_title">有效期</span>
                 {{spersonform.licenseenddate}} -->
			     <!--<select id="year1" onchange="TUpdateCal(ymd.year1.value,ymd.month1.value)"></select><span class="dates">年</span>
                 <select id="month1" onchange="TUpdateCal(ymd.year1.value,ymd.month1.value)" ></select><span class="dates">月</span>
                 <select id="day1"></select><span class="dates">日</span>-->
                <!--span class="tipImg"></span><span class="errTip">输入不能为空</span>
                <span class="errors">{{spersonform.errors.licenseenddate.as_text}}</span>
            </div-->
            <!--div class="clearfix verify_tip">
                <span class="input_title">经营行业</span>
                <select name="mcc" class="fl">
                    <option>宾馆、餐饮、娱乐、珠宝金饰、工艺美术品类</option>
                    <option>房地产、汽车销售、批发类</option>
                    <option>航空售票、加油、超市类</option>
                    <option>公立医院、公立学校类</option>
                    <option>新兴行业</option>
                    <option>其他一般行业</option>
                </select>
            </div-->
            <!--div class="clearfix verify_tip">
                <span class="input_title">收款银行</span>
                <select class="fl" name="banknameprefix">
				{%include "userportal/bank_list.html"%}
                </select>
                <select name="bprovince" class="f1" id="bpro"></select> 
                <select name="bcity" class="f1" id="bcity"></select>
                <span class="tipImg"></span><span class="errTip">输入不能为空</span>
                <span class="errors">{{spersonform.errors.bankname.as_text}}</span>
            </div-->
            <div class="clearfix verify">
                <span class="input_title">收款银行(包含分支行名称)</span>
                <select name="bprovince" class="f1" id="bpro"></select> 
                <select name="bcity" class="f1" id="bcity"></select>
				</label>
                <span class="tipImg"></span><span class="errTip">输入不能为空</span>
			</div>

            <div class="clearfix verify_tip">
                <span class="input_title"></span>
                <label class="clearfix">
				{{spersonform.bankname}}
                </label>
                <span class="tipImg"></span>
                <span class="errTip">输入不能为空</span>	
                <span class="errors">{{spersonform.errors.bankname.as_text}}</span>
            </div>					
            <div class="clearfix verify_tip">
                <label class="clearfix"> <span class="input_title">收款银行开户名称</span> {{spersonform.bankuser}} </label>
                <span class="tipImg"></span><span class="errTip">输入不能为空</span>
                <span class="errors">{{companyform.errors.bankuser.as_text}}</span>
            </div>
            <div class="clearfix verify_tip">
                <label class="clearfix"> <span class="input_title">收款银行账号</span> {{spersonform.bankaccount}} </label>
                <span class="tipImg"></span><span class="errTip">输入不能为空</span>
                <span class="errors">{{spersonform.errors.bankaccount.as_text}}</span>
            </div>
            <div class="clearfix verify">
				<label class="clearfix"> <span class="input_title">确认收款银行账号</span> {{spersonform.confirmbankaccount}} </label>
				<span class="tipImg"></span><span class="errTip">输入不能为空</span>
				<span class="errors">{{spersonform.errors.confirmbankaccount.as_text}}</span>
			</div>

            <div class="clearfix verify_tip">
                <label class="clearfix"> <span class="input_title">出售的商品或服务的描述</span> {{spersonform.mcc}} </label>
                <span class="tipImg"></span><span class="errTip">输入不能为空</span>
                <span class="errors">{{spersonform.errors.mcc.as_text}}</span>
            </div>
            <div class="clearfix verify_tip">
                <span class="input_title">需要读卡器数量</span>
                <select name="terminalcount" class="fl">
                    <option value="1">1台</option>
                    <option value="2">2台</option>
                    <option value="3">3台</option>
                </select>
            </div>
            <p class="form_btm mt_20"><input type="submit" class="submit button" value="提交申请"></p>
        </form>
    </div>
</div>
<script type="text/javascript">

    function verify_idnumber(obj) {
        if (obj.val().match(/^((1[1-5])|(2[1-3])|(3[1-7])|(4[1-6])|(5[0-4])|(6[1-5])|71|(8[12])|91)\d{4}((19\d{2}(0[13-9]|1[012])(0[1-9]|[12]\d|30))|(19\d{2}(0[13578]|1[02])31)|(19\d{2}02(0[1-9]|1\d|2[0-8]))|(19([13579][26]|[2468][048]|0[48])0229))\d{3}(\d|X|x)?$/)) {
            return true;
        } else {
            return false;
        }
    }
    function verify_mobile(obj) {
        if (obj.val().match(/^0{0,1}(13[0-9]|15[0-9]|18[6-9]|180)[0-9]{8}$/)) {
            return true;
        } else {
            return false;
        }
    }
    function verify_telephone(obj) {
        if (obj.val().match(/^(\d{2,3}-)?(\d{3}|\d{4})-(\d{7,10})(-\d+)*$/)) {
            return true;
        } else {
            return false;
        }
    }
    function verify_post(obj) {
        if (obj.val().match(/^\d{6}$/)) {
            return true;
        } else {
            return false;
        }
    }
	function verify_bankaccount(obj){

        if (obj.val().match(/^\d{16,32}$/)) return true 
		else return false;
	}

	function verify_confirmbankaccount(obj){
		if (obj.val()==$("#id_bankaccount").val()){
			return true;
		}	else {
			return false;
		}
	
	
	}
	function verify_company(obj) {
        if (obj.val().match(/^[\u4e00-\u9fa5]+$/)) {
            return true;
        } else {
            return false;
        }
    }
	function verify_city(obj){
	if (obj.val() == "-1") return false;
	else return true;
	}
	$("#id_businessaddr").blur(function(){
		addr_obj = $("#id_businessaddr");
		city_obj = $("#city");
		if(!verify_city(city_obj))
			$.show_msg(city_obj,false, true, "请选择城市");
		else
			$.show_msg(city_obj, false, false,"");
	});
	$("#id_bankname").blur(function(){
		addr_obj = $("#id_bankname");
		city_obj = $("#bcity");
		if(!verify_city(city_obj))
			$.show_msg(city_obj,false, true, "请选择城市");
		else
			$.show_msg(city_obj, false, false,"");
	});

    
    //下边是二级校验的调用方法，当然$("#ID")中的ID是需要手动加在对应input元素上的，这里是身份证，所以取名ID。

    $("#manual").click(function () {
        $(this).hide();
        $(this).next().show();
    });
    $("#id_idnumber").add_verify_listener(verify_idnumber, "您输入的身份证号码格式有误，请重新输入");
	$("#id_shopname").add_verify_listener(verify_company,"请输入字号的中文名称");
	$("#id_legalperson").add_verify_listener(verify_company,"请输入经营者的中文姓名");
	$("#id_bankaccount").add_verify_listener(verify_bankaccount, "请输入16位或32位数字的银行卡号");
    $("#id_confirmbankaccount").add_verify_listener(verify_confirmbankaccount, "您输入的两次银行账号不一致");
	$("#id_telephone").add_verify_listener(verify_telephone, "格式应为:010-12345678");
    $("#id_post").add_verify_listener(verify_post,"您输入的邮政编码格式有误，请重新输入");
</script>

{%endblock%}
